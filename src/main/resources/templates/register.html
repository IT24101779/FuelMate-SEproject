<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="${pageTitle} ?: 'Register - FuelMate'">FuelMate - Register</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --success-color: #27ae60;
      --warning-color: #f39c12;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      padding: 20px 0;
    }

    .register-container {
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      overflow: hidden;
      width: 100%;
      max-width: 1000px;
    }

    .register-left {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: white;
      padding: 40px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    .register-right {
      padding: 40px;
    }

    .brand-logo {
      font-size: 2.5rem;
      margin-bottom: 20px;
    }

    .form-control:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
    }

    .btn-primary-custom {
      background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
      border: none;
      padding: 12px 30px;
      border-radius: 25px;
      font-weight: 600;
      transition: all 0.3s ease;
      width: 100%;
    }

    .btn-primary-custom:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
    }

    .alert-custom {
      border-radius: 10px;
      border: none;
      font-weight: 500;
    }

    @media (max-width: 768px) {
      .register-left {
        padding: 30px 20px;
      }

      .register-right {
        padding: 30px 20px;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <div class="register-container">
    <div class="row g-0">
      <div class="col-lg-5 d-none d-lg-block">
        <div class="register-left">
          <div class="brand-logo">
            <i class="fas fa-gas-pump"></i> FuelMate
          </div>
          <h2 class="mb-4">Join Our Community</h2>
          <p class="mb-4">Create your account to start managing your vehicle services and fuel needs efficiently.</p>
          <div style="font-size: 8rem; opacity: 0.8;">
            <i class="fas fa-user-plus"></i>
          </div>
          <p class="mt-4">Already have an account? <a th:href="@{/login}" class="text-white fw-bold">Sign In</a></p>
        </div>
      </div>
      <div class="col-lg-7">
        <div class="register-right">
          <div class="text-center mb-4 d-lg-none">
            <div class="brand-logo text-primary">
              <i class="fas fa-gas-pump"></i> FuelMate
            </div>
          </div>

          <h2 class="text-center mb-4">Create Account</h2>

          <!-- Alert Messages -->
          <div th:if="${error}" class="alert alert-danger alert-custom alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-circle me-2"></i>
            <span th:text="${error}">Error message</span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>

          <div th:if="${message}" class="alert alert-info alert-custom alert-dismissible fade show" role="alert">
            <i class="fas fa-info-circle me-2"></i>
            <span th:text="${message}">Message</span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>

          <form th:action="@{/register}" th:object="${registerRequest}" method="post">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="firstName" class="form-label">First Name *</label>
                <input type="text" class="form-control" id="firstName" th:field="*{firstName}" required>
                <div class="invalid-feedback">Please provide your first name.</div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="lastName" class="form-label">Last Name *</label>
                <input type="text" class="form-control" id="lastName" th:field="*{lastName}" required>
                <div class="invalid-feedback">Please provide your last name.</div>
              </div>
            </div>

            <div class="mb-3">
              <label for="email" class="form-label">Email Address *</label>
              <input type="email" class="form-control" id="email" th:field="*{email}" required>
              <div class="invalid-feedback">Please provide a valid email.</div>
            </div>

            <div class="mb-3">
              <label for="phone" class="form-label">Phone Number</label>
              <input type="tel" class="form-control" id="phone" th:field="*{phone}" placeholder="Optional">
            </div>

            <div class="mb-3">
              <label for="address" class="form-label">Address</label>
              <textarea class="form-control" id="address" th:field="*{address}" rows="2" placeholder="Optional"></textarea>
            </div>

            <div class="mb-3">
              <label for="role" class="form-label">Account Type *</label>
              <select class="form-select" id="role" th:field="*{role}" required>
                <option value="">Select account type</option>
                <option value="CUSTOMER">Customer</option>
                <option value="FUEL_ATTENDANT">Fuel Attendant</option>
                <option value="MANAGER">Manager</option>
              </select>
              <div class="invalid-feedback">Please select an account type.</div>
              <div class="form-text">Admin and Mechanic accounts are created by system administrators only.</div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="password" class="form-label">Password *</label>
                <input type="password" class="form-control" id="password" th:field="*{password}" required>
                <div class="invalid-feedback">Please provide a password.</div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="confirmPassword" class="form-label">Confirm Password *</label>
                <input type="password" class="form-control" id="confirmPassword" th:field="*{confirmPassword}" required>
                <div class="invalid-feedback">Please confirm your password.</div>
              </div>
            </div>

            <div class="mb-4">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="terms" required>
                <label class="form-check-label" for="terms">
                  I agree to the <a href="#">Terms and Conditions</a>
                </label>
                <div class="invalid-feedback">You must agree before submitting.</div>
              </div>
            </div>

            <button type="submit" class="btn btn-primary-custom mb-3">Create Account</button>

            <div class="text-center">
              <p class="mb-0">Already have an account? <a th:href="@{/login}">Sign In</a></p>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<!-- Form Validation -->
<script>
  // Form validation
  (function () {
    'use strict'

    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.querySelectorAll('form')

    // Loop over them and prevent submission
    Array.prototype.slice.call(forms)
            .forEach(function (form) {
              form.addEventListener('submit', function (event) {
                if (!form.checkValidity()) {
                  event.preventDefault()
                  event.stopPropagation()
                }

                form.classList.add('was-validated')
              }, false)
            })
  })()

  // Password confirmation validation
  document.getElementById('confirmPassword').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const confirmPassword = this.value;

    if (password !== confirmPassword) {
      this.setCustomValidity('Passwords do not match');
    } else {
      this.setCustomValidity('');
    }
  });

  // Auto-dismiss alerts after 5 seconds
  setTimeout(function() {
    const alerts = document.querySelectorAll('.alert');
    alerts.forEach(alert => {
      const bsAlert = new bootstrap.Alert(alert);
      bsAlert.close();
    });
  }, 5000);
</script>
</body>
</html>